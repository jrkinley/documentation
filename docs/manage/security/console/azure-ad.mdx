---
title: Azure AD SSO Setup
---

<head>
    <meta name="title" content="Azure AD SSO Authentication in Redpanda Console | Redpanda Docs"/>
    <meta name="description" content="Configure authentication with external identity providers such as Google, GitHub or Okta in Redpanda Console."/>
</head>

:::info
This feature requires an [Enterprise license](../../../../get-started/licenses). To upgrade, contact [Redpanda sales](https://redpanda.com/try-redpanda?section=enterprise-cloud).
:::

By integrating Redpanda Console with Azure AD, your users can sign in to Redpanda Console using their Azure AD login credentials.

These instructions assume you already have an Azure AD account and permissions to create Applications within your directory.

## Create an OpenID connect application

In the Azure Portal, register your app and generate a client secret.

### Register your app

To register your application, log in to the Azure Portal and provide the following information:

* **Display name** - Choose a descriptive name for your specific Redpanda Console deployment (for example Console Analytics Prod)
* **Supported account types** - Select the types of accounts that can access the API (choose single tenant, multi-tenant, or personal accounts). If you are unsure, click "Help me choose...".
* **Redirect URIs** Select Web as the platform and enter `https://console.<yourcompany>.com/login/callbacks/azure-ad` in the text box. Replace `<your-company>.com` with your company's domain name.

After the app is registered, a summary page opens. This page displays a list of **Essentials**, which you will need when you edit the `redpanda-console-config.yaml file`.

For detailed instructions, see the Microsoft documentation for [configuring an OpenID connect provider](https://learn.microsoft.com/en-us/power-apps/maker/portals/configure/configure-openid-settings).

### Generate the client secret

Redpanda Console requires a client secret to validate the connection request from the redirect URI. To generate a client secret:

1. In the **Essentials** section of the summary page, click **Add a certificate or secret** next to **Client credentials**.

2. On the **Certificates & secrets** page, select the **Client secrets** tab.

3. Click **New client secret**.

4. In the "Add a client secret" pane, enter a description that identifies the app associated with the client secret.

5. Choose a time period that determines when the client secret will expire; for example, 180 days.

When the client secret is generated successfully, it appears under the **Client secrets** tab with its description, expiration date, value, and secret ID.

:::important
Copy the client secret value into the `redpanda-console-config.yaml` file before you leave the **Certificates and secrets** page. After you navigate away from the page, only the first few characters of the client secret value are displayed and you won't be able to copy the value into the configuration file.
:::

## Edit the console configuration file

Edit the `redpanda-console-config.yaml` file, which is in `/etc/redpanda`, and incorporate the details from your app registration.

:::note
The following configurations assume that you want to host Redpanda Console so it is accessible at
`https://console.<your-company>.com`.
:::

```yaml
login:
  enabled: true

  # jwtSecret is the secret key you must use to sign and encrypt the JSON
  # web token used to store user sessions. This secret key is
  # critical for the security of Redpanda Console's authentication and
  # authorization system. Use a long, complex key with a combination of
  # numbers, letters, and special characters. The minimum number of
  # characters is 10, but Redpanda recommends using more than 32
  # characters. For additional security, use a different secret key for
  # each environment.
  #
  # To securely generate a jwtSecret key, run the following
  # command: LC_ALL=C tr -dc '[:alnum:]' < /dev/random | head -c32
  #
  # If you update this secret key, any users who are
  # already logged in to Redpanda Console will be logged out and will have
  # to log in again.
  jwtSecret: ""

  azureAd:
    enabled: true
    # ProviderURL must be specified in the following format:
    # https://login.microsoftonline.com/{tenantId}/v2.0 .
    # To get this URL, browse to the registered app in your 
    # Azure Portal and click the "Endpoints" tab. A drawer 
    # opens with several links. The link below 
    # "OpenID Connect metadata document" contains the 
    # provider URL; however, you must trim the suffix 
    # "/.well-known/openid-configuration" so that it 
    # matches the expected format.
    providerUrl: ""

    clientId: ""
    clientSecret: ""

    #  userIdentifyingClaimKey is only needed when you want 
    #  to use a different claim key to identify users in the 
    #  role binding. By default, Redpanda uses the 'oid' claim key,
    #  which resolves to the unique user ID within the identity 
    #  provider. This means that you must provide the oid 
    #  identifier in the roleBindings as 'name' as well. 
    #  Other common options are:
    #  - upn (unique principal name - you need to add the upn 
    #    claim as a claim for id tokens in your Azure AD application)
    #  - email (under certain conditions there's no value for 
    #    the email propagated)
    userIdentifyingClaimKey: "oid"

    # The directory config is only required if you want to use 
    # Azure AD groups in your role bindings, as described 
    # in the next section.
    # directory:
    #   tenantId: ""
```

## RBAC Azure AD groups sync

You can bind roles to Azure groups from your organization by providing the `tenantId` in the directory configuration and adding API permissions to your client application. To retrieve the `tenantId`, go to
your registered application in the Azure Active Directory portal. The "Directory (tenant) ID" is listed
along with other configurations in the **Essentials** section.

```yaml
login:
  azureAd:
    directory:
      tenantId: ""
```

If you specify the `tenantId`, Redpanda Console will send a request to the Microsoft Graph API to retrieve the memberships
for the specified groups. In order for the Microsoft Graph API to grant the request, the client must have the appropriate permissions. In your AzureAD application,
go to "API permissions" and add the following permissions:

* "Group.Read.All"
* "User.Read.All"
* "Directory.Read.All"

Next, grant admin consent for the default directory by clicking "Grant admin constent for Default Directory".

## Define role-bindings

When you set up the Azure AD login configuration, you can bind Azure AD users or groups to roles. Following is a sample
role binding:

```yaml
roleBindings:
  - metadata:
      name: Developers
    subjects:
      - kind: group
        provider: AzureAD
        # Name for group refers to the group's oid.
        name: ef0dd5b8-93c3-4a4f-9d90-cba243973d32
      - kind: user
        provider: AzureAD
        # Name refers to the user's OID.
        # This depends on your userIdentifyingClaimKey
        # configuration. For example, if you use `email` as the claim key,
        # use the email address for the name.
        name: c86fdb3f-b0f4-4b0b-9be3-ddf56f48b62f
    roleName: editor
```

:::note
The resolved group memberships can also include transitive members. This allows you to create nested groups and refer to them in your role bindings.
:::
